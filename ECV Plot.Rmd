---
title: "Ear Canal Volume Probability Density Function By Age"
author: "E Bryan Crenshaw III with Cody Bender"
date: "March 24, 2017"
output: html_document

---
**Objective**: Plot the probability density function of ear canal volume in three 
age groups (young = age >= 0.5 & age < 3; middle = age >= 3 & age <= 15; old =
(age >= 15 & age <= 21 ). 

**Approach**: Loaded 'nodupecv', a dataset of patients from AudGenDB with no 
tympnaostomy CPT codes checked against a list of tympanostomy patients. Removed 
duplicate entries with the same patient alias. Patients wer divided into 3 age 
groups: young (0.65-3 years), middle (3-15 years), and older (15-21 years). 
Quantiles were calculated for each group and probability density functions were 
plotted.

```{r}
#Data divided into 3 age groups
load(file = "nodupecv.Rdata")
nodupecv_yng <- subset(nodupecv, age >= 0.5 & age < 3,)
nodupecv_mid <- subset(nodupecv, age >= 3 & age < 15,)
nodupecv_old <- subset(nodupecv, age >= 15 & age < 21,)
```
```{r, echo=FALSE, warning=FALSE}
library(psych)
```
**Basic Statistical Analyses:**
```{r}
nodupecv_yng.describe <- describe(nodupecv_yng$ecv)
print("Basic Statistics on Ear Canal Volume of Children 6 months to <3 years Old :"); nodupecv_yng.describe
nodupecv_mid.describe <- describe(nodupecv_mid$ecv)
print("Basic Statistics on Ear Canal Volume of Children 6 months to <3 years Old :"); nodupecv_mid.describe
nodupecv_old.describe <- describe(nodupecv_old$ecv)
print("Basic Statistics on Ear Canal Volume of Children 6 months to <3 years Old :"); nodupecv_old.describe
```

**Quantile Analyses:**
```{r}
# Show quantiles of percents in the probs vector below
ecv_yng <- quantile(nodupecv_yng$ecv,  probs = c(2.5, 5, 10, 50, 90, 95, 97.5, NA)/100, na.rm = TRUE)
print("Quantiles of Younger Children:"); print(ecv_yng);
ecv_mid <- quantile(nodupecv_mid$ecv,  probs = c(2.5, 5, 10, 50, 90, 95, 97.5, NA)/100, na.rm = TRUE)
print("Quantiles of Middle Children:"); print(ecv_mid)
ecv_old <- quantile(nodupecv_old$ecv,  probs = c(2.5, 5, 10, 50, 90, 95, 97.5, NA)/100, na.rm = TRUE)
print("Quantiles of Older Children:"); print(ecv_old)
```

```{r plot} 
# Plot the ecv of the 3 age ranges with outliers removed
plot(density(nodupecv_yng$ecv, na.rm = TRUE), main = "Ear Canal Volume of Children with PTA <=15 dB & No Pathology", xlab = "Ear Canal Volume (mL)", xlim = c(0,2.2), ylim = c(0,2.2))
lines(density(nodupecv_mid$ecv, na.rm = TRUE), col =2)
lines(density(nodupecv_old$ecv, na.rm = TRUE), col = 3)
legend("topright", c("Young (0.5-<3yo)", "Middle (3-15yo)","Older (15-21yo)"), cex=1.1, col=c("black","red","green"), pch=21:23, lty=1:3)
```

































**Observations**: The dataset contained 1840 patients after additional tympanograms performed for each patient after the first were removed. The vast majority of patients fell into the Middle subset between ages 3-15.


**Comparisons By Age**:

The Younger subset contained 60 patients and had a 90% range of ear canal volume from 0.40000 to 0.93150.

The Middle subset contained 1587 patients and had a 90% range of ear canal volume from 0.50000 to 1.31000.

The Older subset contained 193 patients and had a 90% range of ear canal volume from 0.63000 to 1.70000.